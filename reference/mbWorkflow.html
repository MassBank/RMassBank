<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MassBank record creation workflow — mbWorkflow • RMassBank</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MassBank record creation workflow — mbWorkflow"><meta property="og:description" content="Uses data generated by msmsWorkflow to create MassBank records."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMassBank</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.13.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/RMassBank.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/RMassBankNonstandard.html">RMassBank: Non-standard usage</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MassBank record creation workflow</h1>
    
    <div class="hidden name"><code>mbWorkflow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses data generated by <code><a href="msmsWorkflow.html">msmsWorkflow</a></code> to create MassBank records.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mbWorkflow</span><span class="op">(</span></span>
<span>  <span class="va">mb</span>,</span>
<span>  steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  infolist_path <span class="op">=</span> <span class="st">"./infolist.csv"</span>,</span>
<span>  gatherData <span class="op">=</span> <span class="st">"online"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mb</dt>
<dd><p>The <code>mbWorkspace</code> to work in.</p></dd>


<dt>steps</dt>
<dd><p>Which steps in the workflow to perform.</p></dd>


<dt>infolist_path</dt>
<dd><p>A path where to store newly downloaded compound informations,
which should then be manually inspected.</p></dd>


<dt>gatherData</dt>
<dd><p>A variable denoting whether to retrieve information using several online databases <code>gatherData= "online"</code>
or to use the local babel installation <code>gatherData= "babel"</code>. Note that babel is used either way, if a directory is given 
in the settings. This setting will be ignored if retrieval is set to "standard"</p></dd>


<dt>filter</dt>
<dd><p>If <code>TRUE</code>, the peaks will be filtered according to the standard processing workflow in RMassBank - 
only the best formula for a peak is retained, and only peaks passing multiplicity filtering are retained. If FALSE, it is assumed
that the user has already done filtering, and all peaks in the spectrum should be printed in the record (with or without formula.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The processed <code>mbWorkspace</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>See the vignette <code><a href="../articles/RMassBank.html">vignette("RMassBank")</a></code> for detailed informations about the usage.</p>
<p>Steps:</p>
<p>Step 1: Find which compounds don't have annotation information yet. For these
		 compounds, pull information from several databases (using gatherData).</p>
<p>Step 2: If new compounds were found, then export the infolist.csv and stop the workflow.
		Otherwise, continue.</p>
<p>Step 3: Take the archive data (in table format) and reformat it to MassBank tree format.</p>
<p>Step 4: Compile the spectra. Using the skeletons from the archive data, create
  MassBank records per compound and fill them with peak data for each spectrum.
  Also, assign accession numbers based on scan mode and relative scan no.</p>
<p>Step 5: Convert the internal tree-like representation of the MassBank data into
 flat-text string arrays (basically, into text-file style, but still in memory)</p>
<p>Step 6: For all OK records, generate a corresponding molfile with the structure
  of the compound, based on the SMILES entry from the MassBank record. (This molfile
  is still in memory only, not yet a physical file)</p>
<p>Step 7: If necessary, generate the appropriate subdirectories, and actually write
  the files to disk.</p>
<p>Step 8: Create the list.tsv in the molfiles folder, which is required by MassBank
  to attribute substances to their corresponding structure molfiles.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="mbWorkspace-class.html">mbWorkspace-class</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Michael A. Stravs, Eawag &lt;michael.stravs@eawag.ch&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu"><a href="newMbWorkspace.html">newMbWorkspace</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="co"># w being a msmsWorkspace</span></span></span>
<span class="r-in"><span>    <span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadInfolists.html">loadInfolists</a></span><span class="op">(</span><span class="va">mb</span>, <span class="st">"D:/myInfolistPath"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mb</span> <span class="op">&lt;-</span> <span class="fu">mbWorkflow</span><span class="op">(</span><span class="va">mb</span>, steps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="st">"newinfos.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by RMassBank at Eawag, Michael A. Stravs, Emma L. Schymanski, Steffen Neumann, Erik Muller, Paul Stahlhofen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

