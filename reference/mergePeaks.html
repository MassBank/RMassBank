<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Merge peaks for spectra merging, FT shoulder elimination etc. — mergePeaks • RMassBank</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Merge peaks for spectra merging, FT shoulder elimination etc. — mergePeaks"><meta property="og:description" content='This procedure first sorts peaks by intensity (descending sort)
and then starts iterating over the peaks, removing all entries
that deviate "sufficiently far" from the currently selected peak.
See the Details section for a full explanation and information on
how to fine-tune peak removal.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMassBank</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.13.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/RMassBank.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/RMassBankNonstandard.html">RMassBank: Non-standard usage</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merge peaks for spectra merging, FT shoulder elimination etc.</h1>
    
    <div class="hidden name"><code>mergePeaks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This procedure first sorts peaks by intensity (descending sort)
and then starts iterating over the peaks, removing all entries
that deviate "sufficiently far" from the currently selected peak.
See the Details section for a full explanation and information on
how to fine-tune peak removal.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mergePeaks</span><span class="op">(</span><span class="va">peaks</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'data.frame'</span></span>
<span><span class="fu">mergePeaks</span><span class="op">(</span><span class="va">peaks</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix'</span></span>
<span><span class="fu">mergePeaks</span><span class="op">(</span><span class="va">peaks</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'RmbSpectrum2'</span></span>
<span><span class="fu">mergePeaks</span><span class="op">(</span><span class="va">peaks</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Spectrum'</span></span>
<span><span class="fu">mergePeaks</span><span class="op">(</span><span class="va">peaks</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>peaks</dt>
<dd><p>data.frame, matrix or RmbSpectrum2
The peak-table to be merged. In case of an <code>RmbSpectrum2</code>-object,
peaks are retrieved and updated via <code><a href="getData.html">getData</a></code>
and <code><a href="setData.html">setData</a></code>, respectively</p></dd>


<dt>...</dt>
<dd><p>3 numeric values
These define cutoff limits (see details)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>object of the same class as peaks
The result contains a reduced peak-table ordered by m/z</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Three parameters must be passed to <code>mergePeaks</code> for
peak-removal control in this order:
- cutoff_dppm_limit
- cutoff_absolute_limit
- cutoff_intensity_limit
The method iterates through the peaks, beginning with the
highest-intensity peak and in each step removes all other
peaks that fulfill conditions 1 AND 2 relative to the selected peak
1. Their m/z value does not deviate too far from the one of the selected peak.
i.e. if the selected peak is p and the checked peak is c, it holds that
EITHER
|p$mz - c$mz| &lt;= cutoff_absolute_limit
OR
|p$mz - c$mz| &lt;= ppm(p$mz, cutoff_dppm_limit, p=TRUE)
(see <code><a href="ppm.html">ppm</a></code>)
2. Their intensity is much smaller than the one of the selected peak, i.e.
c$mz &lt; cutoff_intensity_limit * p$mz
for a suitable cutoff_intensity_limit between 0 and 1.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getData.html">getData</a></code>, <code><a href="setData.html">setData</a></code>, <code><a href="ppm.html">ppm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu">mergePeaks</span><span class="op">(</span><span class="va">spectrum</span>, <span class="fl">10</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by RMassBank at Eawag, Michael A. Stravs, Emma L. Schymanski, Steffen Neumann, Erik Muller, Paul Stahlhofen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

